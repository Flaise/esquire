{"version":3,"sources":["../../src/scene/translation.js"],"names":[],"mappings":"AAAA,YAAY,CAAA;;AAEZ,IAAI,MAAM,GAAG,OAAO,CAAC,UAAU,CAAC,CAAA;AAChC,IAAI,KAAK,GAAG,OAAO,CAAC,SAAS,CAAC,CAAA;;AAG9B,SAAS,WAAW,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE;AAChC,SAAK,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,CAAA;AACzB,UAAM,CAAC,SAAS,CAAC,IAAI,EAAE;AACnB,qBAAa,EAAE,OAAO,CAAC,YAAY;AACnC,SAAC,EAAE,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC;AAC/B,SAAC,EAAE,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC;KAClC,CAAC,CAAA;AACF,QAAI,CAAC,OAAO,GAAG,SAAS,CAAA;CAC3B;AACD,WAAW,CAAC,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,CAAA;AACtD,MAAM,CAAC,OAAO,GAAG,OAAO,GAAG,WAAW,CAAA;;AAEtC,WAAW,CAAC,SAAS,CAAC,MAAM,GAAG,YAAW;AACtC,QAAG,IAAI,CAAC,OAAO,EACX,OAAM;AACV,QAAI,CAAC,CAAC,CAAC,MAAM,EAAE,CAAA;AACf,QAAI,CAAC,CAAC,CAAC,MAAM,EAAE,CAAA;AACf,SAAK,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;CACpC,CAAA;;AAED,WAAW,CAAC,SAAS,CAAC,IAAI,GAAG,UAAS,OAAO,EAAE;AAC3C,QAAG,IAAI,CAAC,OAAO,EAAE;AACb,YAAG,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE;AACrB,gBAAG,IAAI,CAAC,WAAW,EAAE;AACjB,oBAAI,CAAC,MAAM,EAAE,CAAA;AACb,uBAAM;aACT,MACI;AACD,oBAAI,CAAC,OAAO,GAAG,SAAS,CAAA;aAC3B;SACJ,MACI;;AAED,gBAAI,CAAC,CAAC,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,CAAA;AACxC,gBAAI,CAAC,CAAC,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,CAAA;SAC3C;KACJ;AACD,QAAG,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EACf,OAAM;AACV,WAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAA;AAC3C,SAAK,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,CAAA;AACxC,WAAO,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAA;CAChD,CAAA;;AAED,WAAW,CAAC,SAAS,CAAC,IAAI,GAAG,UAAS,OAAO,EAAE,UAAU,EAAE;AACvD,QAAI,MAAM,GAAG,IAAI,WAAW,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAA;AAC/D,UAAM,CAAC,OAAO,GAAG,IAAI,CAAA;AACrB,UAAM,CAAC,WAAW,GAAG,UAAU,CAAA;AAC/B,WAAO,MAAM,CAAA;CAChB,CAAA","file":"src/scene/translation.js","sourcesContent":["'use strict'\n\nvar sanity = require('./sanity')\nvar Group = require('./group')\n\n\nfunction Translation(avatars, x, y) {\n    Group.call(this, avatars)\n    sanity.constants(this, {\n        _interpolands: avatars.interpolands,\n        x: avatars.interpolands.make(x),\n        y: avatars.interpolands.make(y)\n    })\n    this._copyOf = undefined\n}\nTranslation.prototype = Object.create(Group.prototype)\nmodule.exports = exports = Translation\n\nTranslation.prototype.remove = function() {\n    if(this.removed)\n        return\n    this.x.remove()\n    this.y.remove()\n    Group.prototype.remove.call(this)\n}\n\nTranslation.prototype.draw = function(context) {\n    if(this._copyOf) {\n        if(this._copyOf.removed) {\n            if(this._autoDelete) {\n                this.remove()\n                return\n            }\n            else {\n                this._copyOf = undefined\n            }\n        }\n        else {\n            // TODO: reference-counted interpolands?\n            this.x.setToInitial(this._copyOf.x.curr)\n            this.y.setToInitial(this._copyOf.y.curr)\n        }\n    }\n    if(!this.alive.size)\n        return\n    context.translate(this.x.curr, this.y.curr)\n    Group.prototype.draw.call(this, context)\n    context.translate(-this.x.curr, -this.y.curr)\n}\n\nTranslation.prototype.copy = function(avatars, autoDelete) {\n    var result = new Translation(avatars, this.x.curr, this.y.curr)\n    result._copyOf = this\n    result._autoDelete = autoDelete\n    return result\n}\n"]}