{"version":3,"sources":["../../src/scene/camera.js"],"names":[],"mappings":"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","file":"src/scene/camera.js","sourcesContent":["'use strict'\n\nvar sanity = require('./sanity')\nvar EventDispatcher = require('./eventdispatcher')\nvar Group = require('./group')\n\n\nfunction Camera(avatars) {\n    Group.call(this, avatars)\n    sanity.constants(this, {\n        x: avatars.interpolands.make(0),\n        y: avatars.interpolands.make(0),\n        w: avatars.interpolands.make(0),\n        h: avatars.interpolands.make(0),\n        anchorX: avatars.interpolands.make(0),\n        anchorY: avatars.interpolands.make(0),\n        angle: avatars.interpolands.make(0),\n        onBeforeDraw: new EventDispatcher()\n    })\n    sanity.noAccess(this, 'avatars')\n}\nCamera.prototype = Object.create(Group.prototype)\nmodule.exports = exports = Camera\n\nCamera.prototype.remove = function() {\n    if(this.removed)\n        return\n    this.x.remove()\n    this.y.remove()\n    this.w.remove()\n    this.h.remove()\n    this.anchorX.remove()\n    this.anchorY.remove()\n    this.angle.remove()\n    Group.prototype.remove.call(this)\n}\n\nCamera.prototype.draw = function(context) {\n    this.onBeforeDraw.proc()\n\n    var canvas = context.canvas\n\n    context.save()\n    context.scale(canvas.width / this.w.curr, canvas.height / this.h.curr)\n\n    var dx = -this.x.curr + this.w.curr * this.anchorX.curr\n    var dy = -this.y.curr + this.h.curr * this.anchorY.curr\n    if (dx || dy)\n        context.translate(dx, dy)\n\n    Group.prototype.draw.call(this, context)\n\n    context.restore()\n}\n"]}